
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Citizen Feedback Dashboard</title>
  https://cdn.jsdelivr.net/npm/chart.js
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f4f4f4; }
    h2 { text-align: center; }
    .chart-container { width: 80%; margin: 30px auto; background: #fff; padding: 20px; border-radius: 8px; }
  </style>
</head>
<body>
  <h2>Citizen Feedback Dashboard</h2>

  <div class="chart-container">
    <canvas id="topic_distribution"></canvas>
  </div>
  <div class="chart-container">
    <canvas id="urgency_levels"></canvas>
  </div>
  <div class="chart-container">
    <canvas id="sentiment_analysis"></canvas>
  </div>

  <script>
    async function fetchDashboardData() {
      try {
        const response = await fetch('/dashboard');
        const data = await response.json();
        renderCharts(data);
      } catch (error) {
        console.error("Error fetching dashboard data:", error);
      }
    }

    function renderCharts(data) {
      const topicCtx = document.getElementById('topicChart').getContext('2d');
      new Chart(topicCtx, {
        type: 'bar',
        data: {
          labels: Object.keys(data.topic_distribution),
          datasets: [{
            label: 'Topic Distribution',
            data: Object.values(data.topic_distribution),
            backgroundColor: 'rgba(54, 162, 235, 0.6)'
          }]
        }
      });

      const urgencyCtx = document.getElementById('urgencyChart').getContext('2d');
      new Chart(urgencyCtx, {
        type: 'pie',
        data: {
          labels: Object.keys(data.urgency_levels),
          datasets: [{
            label: 'Urgency Levels',
            data: Object.values(data.urgency_levels),
            backgroundColor: ['#ff6384', '#ffcd56', '#36a2eb']
          }]
        }
      });

      const sentimentCtx = document.getElementById('sentimentChart').getContext('2d');
      new Chart(sentimentCtx, {
        type: 'doughnut',
        data: {
          labels: Object.keys(data.sentiment_analysis),
          datasets: [{
            label: 'Sentiment Analysis',
            data: Object.values(data.sentiment_analysis),
            backgroundColor: ['#4caf50', '#f44336', '#ff9800']
          }]
        }
      });
    }

    fetchDashboardData();
  </script>
</body>
</html>
